<p align="center">
	<img src="https://developer.android.com/images/brand/Android_Robot_100.png" height="200">
	<img src="https://cordova.apache.org/static/img/pluggy.png" height="250">
</p>

# Android Pay
For Cordova :gift:

---

This plugin is a good starting point (and may even be enough) to integrate Android Pay in your cordova-based app.

It has originally been created for [Bsit](https://bsit.com/). We ([Togetair](https://togetair.com)) will keep it updated and maintained.

Don't hesitate to make a pull request if you can contribute.

---

## TODOs :rocket:
- Clean up code
- Fire events
	- gAPI errors
	- gAPI connect
	- gAPI disconnect
- Write examples
- Embed (or make an overlay) the WalletFragment (you should use an image for now)
- "How to test?" - there is no reliable way to test Android Pay at the moment, at least using Stripe.
- **Release as a plugin**.

---

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Constants](#constants)
    -   [ACTIONS_RESPONSES](#actions_responses)
    -   [WalletConstants](#walletconstants)
    -   [CommonStatusCodes](#commonstatuscodes)
    -   [CardNetwork](#cardnetwork)
    -   [PaymentMethodTokenizationType](#paymentmethodtokenizationtype)
    -   [Activity](#activity)
-   [AndroidPay](#androidpay)
    -   [on](#on)
    -   [setup](#setup)
    -   [setTag](#settag)
    -   [setEnvironment](#setenvironment)
    -   [addAllowedCard](#addallowedcard)
    -   [setTheme](#settheme)
    -   [setPaymentMethodTokenizationType](#setpaymentmethodtokenizationtype)
    -   [addPaymentMethodTokenizationParameter](#addpaymentmethodtokenizationparameter)
    -   [setMerchantName](#setmerchantname)
    -   [setPhoneNumberRequired](#setphonenumberrequired)
    -   [bootstrap](#bootstrap)
    -   [isReadyToPay](#isreadytopay)
    -   [setCart](#setcart)
    -   [loadWallet](#loadwallet)
    -   [loadMaskedWallet](#loadmaskedwallet)

## Constants

These constants are mostly an exact copy of their Java's counterparts.

### ACTIONS_RESPONSES

**Properties**

-   `MESSAGES` **[object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** Un/successful values
    -   `MESSAGES.IS_READY_TO_PAY` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Sent when #isReadyToPay() is successful
    -   `MESSAGES.IS_NOT_READY_TO_PAY` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Sent when #isReadyToPay() is not succesfull

### WalletConstants

com.google.android.gms.wallet.WalletConstants

**Properties**

-   `RESULT_ERROR` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `EXTRA_IS_USER_PREAUTHORIZED` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `EXTRA_MASKED_WALLET` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `EXTRA_FULL_WALLET` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `EXTRA_ERROR_CODE` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `EXTRA_MASKED_WALLET_REQUEST` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `EXTRA_IS_NEW_USER` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `EXTRA_IS_READY_TO_PAY` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `EXTRA_WEB_PAYMENT_DATA` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `ERROR_CODE_SERVICE_UNAVAILABLE` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_INVALID_PARAMETERS` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_MERCHANT_ACCOUNT_ERROR` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_SPENDING_LIMIT_EXCEEDED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_BUYER_ACCOUNT_ERROR` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_INVALID_TRANSACTION` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_AUTHENTICATION_FAILURE` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_UNSUPPORTED_API_VERSION` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR_CODE_UNKNOWN` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ENVIRONMENT_PRODUCTION` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ENVIRONMENT_TEST` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ENVIRONMENT_SANDBOX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ENVIRONMENT_STRICT_SANDBOX` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `THEME_DARK` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `THEME_LIGHT` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ACTION_ENABLE_WALLET_OPTIMIZATION` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `METADATA_TAG_WALLET_API_ENABLED` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### CommonStatusCodes

com.google.android.gms.common.api.CommonStatusCodes

**Properties**

-   `SUCCESS_CACHE` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `SUCCESS` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `SERVICE_VERSION_UPDATE_REQUIRED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `SERVICE_DISABLED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `SIGN_IN_REQUIRED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `INVALID_ACCOUNT` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `RESOLUTION_REQUIRED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `NETWORK_ERROR` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `INTERNAL_ERROR` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `DEVELOPER_ERROR` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `ERROR` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `INTERRUPTED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `TIMEOUT` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `CANCELED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `API_NOT_CONNECTED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `DEAD_CLIENT` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

### CardNetwork

com.google.android.gms.wallet.WalletConstants.CardNetwork

**Properties**

-   `AMEX` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `DISCOVER` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `JCB` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `MASTERCARD` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `VISA` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `INTERAC` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `OTHER` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

### PaymentMethodTokenizationType

com.google.android.gms.wallet.PaymentMethodTokenizationType

**Properties**

-   `PAYMENT_GATEWAY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `NETWORK_TOKEN` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

### Activity

android.app.Activity

**Properties**

-   `RESULT_CANCELED` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `RESULT_OK` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## AndroidPay

-   **See: [Android Pay (Native) Tutorial](https://developers.google.com/android-pay/tutorial)**

**Examples**

```javascript
var AndroidPay = cordova.plugins.AndroidPay;

AndroidPay.setup({
  environment: AndroidPay.Constants.WalletConstants.ENVIRONMENT_TEST,
  paymentMethodTokenizationParameters: {
    gateway: 'stripe',
    'stripe:publishableKey': 'pk_test_XXX',
    'stripe:version': 'YYYY-MM-DD'
  },
  allowedCards: [
    AndroidPay.Constants.CardNetwork.VISA,
    AndroidPay.Constants.CardNetwork.MASTERCARD
 ]
})
.then(function(result) { 
  console.log(result);
  return AndroidPay.bootstrap();
})
.then(function(result) {
  console.log(result);
  return AndroidPay.isReadyToPay();
})
.then(function(readyToPay) {
  console.log(result);

  if (!readyToPay) {
    return Promise.reject(new Error('User is not ready to pay'));
  }
	
 return AndroidPay.setCart({
   currencyCode: 'EUR',
   totalPrice: '1.00',
   lineItems: [
    {
      currencyCode: 'EUR',
      quantity: '1',
      description: '',
      totalPrice: '1.00',
      unitPrice: '1.00'
    }
  ]
 })
})
.then(function(result) {
  console.log(result);
  return AndroidPay.loadMasketWallet();
})
.then(function(tokenizationResult) {
  console.log(tokenizationResult);

  // send to server
})
.catch(function(err) {
  console.log(err);
});
```

### on

**Parameters**

-   `event` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `listener` **[Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 
-   `args` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.on('error', function(e) {
	console.log(e);
});
```

### setup

**Parameters**

-   `options` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
    -   `options.tag` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
    -   `options.allowedCards` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** 
    -   `options.environment` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
    -   `options.theme` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
    -   `options.paymentMethodTokenizationType` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
    -   `options.paymentMethodTokenizationParameters` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
        -   `options.paymentMethodTokenizationParameters.gateway` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
    -   `options.merchantName` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
    -   `options.phoneNumberRequired` **[Boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.setup({
	environment: cordova.plugins.AndroidPay.Constants.WalletConstants.ENVIRONMENT_TEST,
	paymentMethodTokenizationParameters: {
		gateway: 'stripe',
		'stripe:publishableKey': 'pk_test_XXX',
		'stripe:version': 'YYYY-MM-DD'
	},
	allowedCards: [
   AndroidPay.Constants.CardNetwork.VISA,
   AndroidPay.Constants.CardNetwork.MASTERCARD
	]
})
.then(function(result) { 
	console.log(result);
})
.catch(function(err) {
	console.log(err);
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setTag

**Parameters**

-   `tag` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setEnvironment

**Parameters**

-   `environment` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.setEnvironment(cordova.plugins.AndroidPay.Constants.WalletConstants.ENVIRONMENT_TEST)
.then(function(result) {
	console.log(result);
})
.catch(function(err) {
	console.log(err);
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### addAllowedCard

**Parameters**

-   `card` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.addAllowedCard(cordova.plugins.AndroidPay.Constants.CardNetwork.VISA)
.then(function(result) {
	console.log(result);
})
.catch(function(err) {
	console.log(err);
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setTheme

**Parameters**

-   `theme` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.setTheme(cordova.plugins.Constants.WalletConstants.THEME_LIGHT)
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setPaymentMethodTokenizationType

**Parameters**

-   `paymentMethodTokenizationType` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.setPaymentMethodTokenizationType(cordova.plugins.Android.Constants.PaymentMethodTokenizationType.PAYMENT_GATEWAY) 
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### addPaymentMethodTokenizationParameter

**Parameters**

-   `key` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `value` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.addPaymentMethodTokenizationParameter('stripe:publishableKey', 'pk_test_XXX')
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setMerchantName

**Parameters**

-   `merchantName` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.setMerchantName('Merchant')
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setPhoneNumberRequired

**Parameters**

-   `phoneNumberRequired` **[Boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.setPhoneNumberRequired(true)
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### bootstrap

**Examples**

```javascript
cordova.plugins.AndroidPay.bootstrap()
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### isReadyToPay

**Examples**

```javascript
cordova.plugins.AndroidPay.isReadyToPay()
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setCart

**Parameters**

-   `options` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
    -   `options.currencyCode` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
    -   `options.totalPrice` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
    -   `options.lineItems` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** 
        -   `options.lineItems.currencyCode` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
        -   `options.lineItems.quantity` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
        -   `options.lineItems.description` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
        -   `options.lineItems.totalPrice` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
        -   `options.lineItems.unitPrice` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

**Examples**

```javascript
cordova.plugins.AndroidPay.setCart({
 currencyCode: 'EUR',
 totalPrice: '1.00',
 lineItems: [
   {
     currencyCode: 'EUR',
     quantity: '1',
     description: '',
     totalPrice: '1.00',
     unitPrice: '1.00'
   }
 ]
})
.then(function(result) {
	console.log(result);
})
.then(function(err) {
	console.log(err);
});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### loadWallet

**Examples**

```javascript
cordova.plugins.AndroidPay.loadWallet()
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### loadMaskedWallet

**Examples**

```javascript
cordova.plugins.AndroidPay.loadMaskedWallet()
	.then(function(result) {
		console.log(result);
	})
	.then(function(err) {
		console.log(err);
	});
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 
